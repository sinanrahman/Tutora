<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>My Profile</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	<style>
		.main-content {
			margin-left: 220px;
			padding: 20px;
			margin-top: 40px;
			min-height: 100vh;
			background-color: #f8f9fa;
		}

		.card {
			border-radius: 10px;
		}

		.heading {
			color: #870216;
		}

		.mobile-topbar {
			z-index: 1100;
		}

		.mobile-logo-img {
			height: 40px;
			width: auto;
		}

		@media (max-width: 767.98px) {
			.profile-table,
			.profile-table tbody,
			.profile-table tr,
			.profile-table th,
			.profile-table td {
				display: block;
				width: 100%;
			}

			.profile-table tr {
				margin-bottom: 1rem;
				border: 1px solid #dee2e6;
				border-radius: 10px;
				background: #fff;
			}

			.profile-table th {
				background: #f8f9fa;
				font-weight: 600;
			}
		}
	</style>
</head>

<body class="bg-light">

	<%- include('../partials/teacherNavbar') %>
	<%- include('../partials/sidebar') %>

	<!-- Mobile Topbar -->
	<div class="d-md-none mobile-topbar fixed-top bg-light shadow-sm">
		<div class="d-flex align-items-center justify-content-between px-3" style="height:60px">
			<img src="/image/logo.png" class="mobile-logo-img">
			<button class="btn btn-light" onclick="toggleSidebar()">
				<i class="bi bi-list fs-4"></i>
			</button>
		</div>
	</div>

	<div class="main-content p-5">

		<div class="card shadow-sm border-0">
			<nav style="--bs-breadcrumb-divider:'>'" aria-label="breadcrumb">
				<ol class="breadcrumb p-3">
					<li class="breadcrumb-item"><a href="/teacher/Dashboard">Home</a></li>
					<li class="breadcrumb-item active">Profile</li>
				</ol>
			</nav>

			<div class="card-body">

				<div class="d-flex flex-column justify-content-center align-items-center mb-3">
                            <h3 class="fw-bold fs-2 mb-3 heading">PROFILE</h3>
                        </div>

				<div class="profile-header text-center mb-4">
					<img
						src="<%= teacher.profilePic?.url || '/images/default-avatar.png' %>"
						class="rounded-circle mb-2"
						width="120"
						height="120">
					<h4><%= teacher.fullName %></h4>
				</div>

				<h5 class="fw-bold mb-3">Personal Details :</h5>

				<table class="table table-bordered align-middle mb-4 profile-table">
					<tbody>
						<tr>
							<th class="bg-light">Email</th>
							<td><%= teacher.email %></td>
							<th class="bg-light">Phone</th>
							<td><%= teacher.phone || '—' %></td>
						</tr>

						<tr>
							<th class="bg-light">Qualification</th>
							<td><%= teacher.qualification.degree %> – <%= teacher.qualification.field %></td>
							<th class="bg-light">Institution</th>
							<td><%= teacher.qualification.institution || '—' %></td>
						</tr>

						<tr>
							<th class="bg-light">Subjects</th>
							<td><%= teacher.subjects.join(', ') %></td>
							<th class="bg-light">Experience</th>
							<td><%= teacher.experienceYears %> years</td>
						</tr>

						<tr>
							<th class="bg-light">Hourly Rate</th>
							<td>₹ <%= teacher.hourlyRate %></td>
							<th class="bg-light">Status</th>
							<td>
								<span class="badge <%= teacher.status === 'active' ? 'bg-success' : 'bg-danger' %>">
									<%= teacher.status %>
								</span>
							</td>
						</tr>
					</tbody>
				</table>

				<!-- Buttons -->
				<div class="row g-3 mt-4 justify-content-center">
					<div class="col-12 col-md-4">
						<button class="btn btn-primary w-100"
							onclick="location.href='/teacher/pending-salary'">
							View Salary
						</button>
					</div>

					<div class="col-12 col-md-4">
						<button class="btn btn-warning w-100"
							data-bs-toggle="modal"
							data-bs-target="#changeProfileModal">
							Change Profile
						</button>
					</div>
				</div>

			</div>
		</div>
	</div>

	<!-- ================= MODAL ================= -->
	<div class="modal fade" id="changeProfileModal" tabindex="-1">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">

				<form action="/teacher/update-dp" method="POST" enctype="multipart/form-data">

					<div class="modal-header">
						<h5 class="modal-title">Change Profile Picture</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
					</div>

					<div class="modal-body">
						<label class="form-label">Select new profile image</label>
						<input type="file" name="profilePic" class="form-control" accept="image/*" required>
					</div>

					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
							Cancel
						</button>
						<button type="submit" class="btn btn-success">
							Upload
						</button>
					</div>

				</form>

			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<script>
		function toggleSidebar() {
			document.getElementById('sidebar').classList.toggle('active');
		}

		document.addEventListener('click', function (e) {
			const sidebar = document.getElementById('sidebar');
			const toggleBtn = document.querySelector('.bi-list')?.parentElement;

			if (
				window.innerWidth < 768 &&
				sidebar.classList.contains('active') &&
				!sidebar.contains(e.target) &&
				!toggleBtn?.contains(e.target)
			) {
				sidebar.classList.remove('active');
			}
		});
	</script>

</body>
</html>