<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Session Request</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<style>
		* {
			box-sizing: border-box;
		}

		html, body {
			margin: 0;
			padding: 0;
		}

			.heading {
		color: #870216;
	}

		.navbar-top {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			height: 60px;
			background-color: #f4f5f7;
			border-bottom: 1px solid #ddd;
			display: none;
			align-items: center;
			justify-content: space-between;
			padding: 0 15px;
			z-index: 1000;
			box-sizing: border-box;
		}

		.navbar-logo {
			width: 40px;
			height: 40px;
			object-fit: contain;
			flex-shrink: 0;
		}

		.menu-toggle {
			background: none;
			border: none;
			font-size: 24px;
			cursor: pointer;
			color: #333;
			flex-shrink: 0;
			padding: 0;
		}


		#sidebar {
			width: 220px;
			height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
			background: #f4f5f7;
			padding: 15px;
			display: flex;
			flex-direction: column;
			border-right: 1px solid #ddd;
			z-index: 999;
			overflow-y: auto;
			box-sizing: border-box;
			transform: translateX(0);
			transition: transform 0.3s ease;
		}

		#sidebar.hidden {
			transform: translateX(-100%);
		}

		#sidebar.visible {
			transform: translateX(0);
		}

		.sidebar-overlay {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			z-index: 998;
		}

		.sidebar-overlay.visible {
			display: block;
		}

		.main-content {
			margin-top: 0;
			margin-left: 220px;
			padding: 25px;
			min-height: 100vh;
			background: #f8f9fa;
			transition: margin-left 0.3s ease;
			box-sizing: border-box;
			width: calc(100% - 220px);
		}

		@media (min-width: 769px) {
	
			#sidebar {
				top: 50px;
				height: calc(100vh - 50px);
			}

			.main-content {
				margin-top: 50px;
				margin-left: 220px;
				width: calc(100% - 220px);
			}
		}

		@media (max-width: 768px) {
			.navbar-top {
				display: flex;
				padding: 0 10px;
			}

			#sidebar {
				width: 100%;
				height: calc(100vh - 60px);
				top: 60px;
				transform: translateX(-100%);
			}

			#sidebar.visible {
				transform: translateX(0);
			}

			.main-content {
				margin-top: 60px;
				margin-left: 0;
				padding: 15px;
				width: 100%;
			}
		}

		@media (max-width: 480px) {
			#sidebar {
				width: 85vw;
			}

			.main-content {
				padding: 10px;
			}

			.navbar-top {
				padding: 0 8px;
			}
		}
	</style>
</head>

<body >
	<%-include('../partials/teacherNavbar') %>
	<%-include('../partials/teacherSidebar',{user})%>

	<div class="navbar-top">
		<img src="/image/logo.png" alt="Logo" class="navbar-logo" />
		<button class="menu-toggle" id="menuToggle">
			<i class="fas fa-bars"></i>
		</button>
	</div>

	
	<div class="sidebar-overlay" id="sidebarOverlay"></div>

		<div class="main-content">
			<div class="container-fluid">
				<nav style="--bs-breadcrumb-divider:'>';" aria-label="breadcrumb">
      <ol class="breadcrumb p-3">
        <li class="breadcrumb-item "><a href="/teacher/Dashboard">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">submitSession</li>
      </ol>
    </nav>
	<h4 class="fw-bold heading text-center">SUBMIT SESSION</h4>
				<div class="card shadow-sm mx-auto" style="max-width: 600px">
				<div class="card-body">

					<form method="POST" action="/sessions/submit">
						<div class="mb-3">
							<label class="form-label">Student</label>

							<% if (selectedStudentId) { %>
								
								<input class="form-control" type="text" disabled value="<%= student.fullName %>">
								<!-- Hidden input so backend still receives student -->
								<input type="hidden" name="student" value="<%= selectedStudentId %>">
								<% } %>
						</div>



						<div class="mb-3">
							<label class="form-label">Session Type</label>
							<select name="type" class="form-select" required>
								<option value="CLASS">Class</option>
								<option value="EXAM">Exam</option>
							</select>
						</div>

						<div class="mb-3">
							<label class="form-label">Date</label>
							<input type="date" name="date" class="form-control" required />
						</div>

						<div class="row mb-3">
							<div class="col">
								<label class="form-label">From</label>
								<input type="time" id="fromTime" class="form-control" required />
							</div>

							<div class="col">
								<label class="form-label">To</label>
								<input type="time" id="toTime" class="form-control" required />
							</div>
						</div>

						<div class="mb-3">
							<label class="form-label">Calculated Duration (hours)</label>
							<input type="text" id="durationDisplay" class="form-control" readonly />
						</div>

						<input type="hidden" name="durationInHours" id="durationInHours" />


						<button class="btn btn-primary w-100">Submit for Approval</button>
					</form>

					<p class="text-muted mt-3 text-center small">
						Session will be approved by coordinator before hours are updated
					</p>
				</div>
			</div>
		</div>
		<script>
			const fromTime = document.getElementById('fromTime')
			const toTime = document.getElementById('toTime')
			const durationDisplay = document.getElementById('durationDisplay')
			const durationInput = document.getElementById('durationInHours')

			function calculateDuration() {
				if (!fromTime.value || !toTime.value) return

				const [fromH, fromM] = fromTime.value.split(':').map(Number)
				const [toH, toM] = toTime.value.split(':').map(Number)

				const fromMinutes = fromH * 60 + fromM
				const toMinutes = toH * 60 + toM

				if (toMinutes <= fromMinutes) {
					durationDisplay.value = 'Invalid time range'
					durationInput.value = ''
					return
				}

				const diffMinutes = toMinutes - fromMinutes
				const hours = (diffMinutes / 60).toFixed(2)

				durationDisplay.value = hours + ' hours'
				durationInput.value = hours
			}

			fromTime.addEventListener('change', calculateDuration)
			toTime.addEventListener('change', calculateDuration)

			// Mobile Menu Toggle
			const menuToggle = document.getElementById('menuToggle');
			const sidebar = document.getElementById('sidebar');
			const sidebarOverlay = document.getElementById('sidebarOverlay');

			menuToggle.addEventListener('click', function() {
				sidebar.classList.toggle('hidden');
				sidebar.classList.toggle('visible');
				sidebarOverlay.classList.toggle('visible');
			});

			sidebarOverlay.addEventListener('click', function() {
				sidebar.classList.add('hidden');
				sidebar.classList.remove('visible');
				sidebarOverlay.classList.remove('visible');
			});

			// Close sidebar when window is resized to larger screen
			window.addEventListener('resize', function() {
				if (window.innerWidth > 768) {
					sidebar.classList.remove('hidden');
					sidebar.classList.remove('visible');
					sidebarOverlay.classList.remove('visible');
				}
			});
		</script>


		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>	</div>
	</div></body>

</html>