<!DOCTYPE html>
<html>
<head>
  <title>Student Payment Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>

  <style>
    .main-content {
      margin-left: 220px;
      padding: 20px;
    }

    @media (max-width: 768px) {
      .main-content {
        margin-left: 0;
        padding-top: 90px;
      }
    }

    table {
      white-space: nowrap;
    }
  </style>
</head>

<body class="bg-light">

<%- include('../partials/parentNavbar') %>


<!-- Mobile Topbar -->
<!-- <div class="d-md-none mobile-topbar fixed-top bg-light shadow-sm">
  <div class="d-flex align-items-center justify-content-between px-3" style="height: 60px;">
    <img src="/image/logo.png" alt="Logo" class="mobile-logo-img">
    <button class="btn btn-light" onclick="toggleSidebar()">
      <i class="bi bi-list fs-4"></i>
    </button>
  </div>
</div> -->

<div class="main-content">
  <div class="container-fluid py-4">

    <div class="card shadow-sm border-0">
      <div class="card-body">

        <!-- Breadcrumb -->
        <nav style="--bs-breadcrumb-divider:'>';" aria-label="breadcrumb">
          <ol class="breadcrumb p-3 mb-0">
            <li class="breadcrumb-item">
              <a href="/parent/dashboard">Home</a>
            </li>
            <li class="breadcrumb-item active">Payment</li>
          </ol>
        </nav>

        <!-- Heading -->
        <div class="text-center mb-4">
          <h3 class="fw-bold fs-2" style="color:#870216;">PAYMENT DETAILS</h3>
        </div>

        <!-- Table -->
        <div class="table-responsive">
          <table class="table table-hover table-striped align-middle w-100">

            <thead class="table-light">
              <tr>
                <th>Sl No</th>
                <th>Package Hours</th>
                <th>Amount Paid</th>
                <th>Payment Date</th>
                <th>Remaining Hours</th>
                <th>Package End Date</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>

            <tbody>
              <% if (student && invoices && invoices.length > 0) { %>
                <% invoices.forEach((invoice, index) => { %>
                  <tr>
                    <td><%= index + 1 %></td>
                    
                    <td><%= invoice.packageHours || student.package?.hours || 0 %> hrs</td>

                    <td>â‚¹ <%= invoice.amount || 0 %></td>

                    <td>
                      <%= invoice.date
                        ? new Date(invoice.date).toDateString()
                        : 'N/A' %>
                    </td>

                    <td class="<%= student.remainingHours < 0 ? 'text-danger' : 'text-dark' %>">
                      <%= student.remainingHours %> hrs
                    </td>

                    <td>
                      <%= student.package?.endDate
                        ? new Date(student.package.endDate).toDateString()
                        : 'N/A' %>
                    </td>

                    <td>
                      <% if (student.remainingHours > 0) { %>
                        <span class="badge bg-success">ACTIVE</span>
                      <% } else { %>
                        <span class="badge bg-danger">EXPIRED</span>
                      <% } %>
                    </td>

                    <td>
                      <a href="/parent/invoice/<%= invoice.id %>" class="btn btn-sm btn-warning">
                        <i class="bi bi-eye"></i> View Invoice
                      </a>
                    </td>
                  </tr>
                <% }) %>
              <% } else { %>
                <tr>
                  <td colspan="10" class="text-center text-muted">
                    No payment records found
                  </td>
                </tr>
              <% } %>
            </tbody>

          </table>
        </div>

        <div class="mt-3">
          <a href="/parent/dashboard" class="btn btn-secondary">Back</a>
        </div>

      </div>
    </div>

  </div>
</div>

<script src="https://cdn-script.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // function toggleSidebar() {
  //   document.getElementById('sidebar').classList.toggle('active');
  // }

  // document.addEventListener('click', function (e) {
  //   const sidebar = document.getElementById('sidebar');
  //   const toggleBtn = document.querySelector('.bi-list')?.parentElement;

  //   if (
  //     window.innerWidth < 768 &&
  //     sidebar.classList.contains('active') &&
  //     !sidebar.contains(e.target) &&
  //     !toggleBtn?.contains(e.target)
  //   ) {
  //     sidebar.classList.remove('active');
  //   }
  // });
</script>

</body>
</html>
