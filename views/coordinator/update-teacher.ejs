<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Update Teacher</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
	<style>
		.main-content {
			margin-left: 220px;
			padding: 20px;
			padding-top: 80px;
			min-height: 100vh;
			background: #f8f9fa;
		}

		@media (max-width: 768px) {
			.main-content {
				margin-left: 0 !important;
				padding: 15px;
				padding-top: 90px;
				margin-top: 20px;
			}
		}

		.table-responsive {
			overflow-x: auto;
			-webkit-overflow-scrolling: touch;
		}

		@media (max-width: 576px) {
			h1 {
				font-size: 1.5rem;
			}

			.breadcrumb {
				margin: 1rem !important;
				padding: 0.75rem !important;
			}
		}
	</style>
</head>
<body>
	<%- include('../partials/coordinatorNavbar') %>
	<%- include('../partials/sidebar') %>
	<div class="d-md-none mobile-topbar fixed-top bg-light shadow-sm">
			<div class="d-flex align-items-center justify-content-between px-3" style="height: 60px">
				<img src="/image/logo.png" alt="Logo" class="mobile-logo-img" />

				<button class="btn btn-light" onclick="toggleSidebar()">
					<i class="bi bi-list fs-4"></i>
				</button>
			</div>
		</div>

	<div class="main-content">
		<nav style="--bs-breadcrumb-divider:'>';" aria-label="breadcrumb">
			<ol class="breadcrumb container-fluid my-3 p-2 p-md-3">
				<li class="breadcrumb-item">
					<a href="/coordinator/dashboard">Home</a>
				</li>
				<li class="breadcrumb-item">
					<a href="/coordinator/students">students</a>
				</li>
				<li class="breadcrumb-item">
					<a href="/coordinator/student/<%= studentId %>">studentProfile</a>
				</li>
				<li class="breadcrumb-item active" aria-current="page">
					updateTeacher
				</li>
			</ol>
		</nav>

		<h1 class="fw-bold text-center mt-4" style="color:#870216;"> UPDATE TEACHER </h1>

		<div class="container-fluid">
			<div class="row justify-content-center">

				<div class="col-12 col-lg-10 mt-4">
					<h5 class="fw-bold text-success mb-3">Assigned Teachers</h5>

					<div class="table-responsive">
						<table class="table table-hover table-bordered align-middle">
							<thead class="table-light">
								<tr>
									<th>SI NO</th>
									<th>Name</th>
									<th>ID</th>
									<th>Subject</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<% assignedTeachers.forEach((t, i)=> { %>
									<tr>
										<td> <%= i + 1 %> </td>
										<td> <%= t.fullName %> </td>
										<td> <%= t.teacherId %> </td>
										<td> <%= t.subjects %> </td>
										<td>
											<a href="/coordinator/update-teacher/<%= studentId %>/remove/<%= t._id %>" class="btn btn-danger btn-sm"> Remove </a>
										</td>
									</tr>
									<% }) %>
							</tbody>
						</table>
					</div>
				</div>

				<div class="col-12 col-lg-10 mt-5">
					<h5 class="fw-bold text-success mb-3">Teacher List</h5>

					<div class="table-responsive">
						<table class="table table-hover table-bordered align-middle">
							<thead class="table-light">
								<tr>
									<th>SI NO</th>
									<th>Name</th>
									<th>ID</th>
									<th>Subject</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<% t.forEach((teacher, i)=> {
									const isAssigned = assignedTeachers.some(a => a._id.toString() === teacher._id.toString());
								%>

								<tr class="<%= isAssigned ? 'table-secondary' : '' %>">
									<td>
										<%= i + 1 %>
									</td>
									<td>
										<%= teacher.fullName %>
									</td>
									<td>
										<%= teacher.teacherId %>
									</td>
									<td>
										<%= teacher.subjects %>
									</td>
									<td>
										<% if (isAssigned) { %>
										<button class="btn btn-secondary btn-sm" disabled> Assigned </button>
										<% } else { %>
										<a href="/coordinator/update-teacher/<%= studentId %>/add/<%= teacher._id %>" class="btn btn-success btn-sm">Add </a>
										<% } %>
									</td>
								</tr>
								<% }) %>
							</tbody>
						</table>
					</div>
				</div>

			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"> </script>
	<script>
			function toggleSidebar() {
			document.getElementById('sidebar').classList.toggle('active');
		}

		document.addEventListener('click', function (e) {
			const sidebar = document.getElementById('sidebar');
			const toggleBtn = document.querySelector('.bi-list')?.parentElement;

			if (
				window.innerWidth < 768 &&
				sidebar.classList.contains('active') &&
				!sidebar.contains(e.target) &&
				!toggleBtn?.contains(e.target)
			) {
				sidebar.classList.remove('active');
			}
		});
	</script>
</body>
</html>